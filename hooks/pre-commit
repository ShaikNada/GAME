#!/bin/bash

echo "Running pre-commit hook..."

# Level 1 check (only if ans.txt exists)
if [ -f "./ans.txt" ]; then
  # Read the answer from ans.txt
  ANSWER=$(<./ans.txt)

  # Expected answer for Level 1
  EXPECTED="DECRYPT"

  # Check if the answer matches the expected value
  if [ "$ANSWER" == "$EXPECTED" ]; then
    echo "Answer verified successfully. Proceeding with the commit."

    # Introduce Level 2
    echo "Congratulations! You've completed Level 1."
    echo "Welcome to Level 2!"
    echo "While running, you find yourself at a crossroads with three paths to choose from. Be aware of the consequences, as choosing the wrong path may lead to your demise, while the right path will bring you closer to your escape."

    # Remove ans.txt to indicate progression to the next level
    rm ./ans.txt
    echo "Level 1 file 'ans.txt' has been removed as you progress to Level 2."

    exit 0  # Allows the commit
  else
    echo "Error: The answer in ans.txt is incorrect. Expected: HELLO WORLD"
    exit 1  # Prevents the commit
  fi
fi

# Default behavior if neither level is met
echo "Error: You have not provided the required file for the current level."
exit 1